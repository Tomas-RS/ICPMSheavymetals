# ICPMSheavymetals
ICPMSheavymetals package for R analysis of inductively coupled plasma mass spectrometry (ICP-MS) data.

This repository contains an R package that was developed to facilitate ICP-MS data analysis using R. 
This was specifically made for the Heavy Metals Project collaboration between the Murphy lab and CBR at UBC. 
ICP-MS data analysis R scripts were adapted into three separate functions.

These are the functions to use if analyzing cadmium concentration without drift adjustment:

setup_all1 – This first function takes the ICP-MS raw results (.csv file) and arranges the relevant data into a data frame named ‘Intensities’. 
Input into the function is a .csv file name (e.g. “Sample_run_test”).

setup_cadmium2 – This second function takes the ‘Intensities’ data frame and rearranges the data for just the cadmium results, giving the ‘Cadmium_analysis’ data frame. 
Alternatively, there are other functions (setup_lead2 and setup_mercury2) available when other metals are being analyzed. 
Input into the functions are “Cd_111”, “Pb_208”, or “Hg_202”, along with ‘Intensities’ to use the data frame generated by the first function.

analyse_cadmium3 – This last function takes the ‘Cadmium_analysis’ data frame and carries out the remainder of the data analysis using the In_115 internal standard. 
This includes plotting baseline drift, subtracting blanks, plotting a standard curve, converting to ppb, then adjusting for dilution factor (1/50). 
The output is the cadmium concentration in the original sample. If you want to adjust according to baseline drift, instead use the analyse_cadmium_withdrift3 function. 
Similar functions exist for lead (analyse_lead3, analyse_lead_withdrift3) and mercury (analyse_mercury3, analyse_mercury_withdrift3) which use the Ir_193 internal standard. 
Inputs into the functions include ‘Cadmium_analysis’, ‘Mercury_analysis’, or ‘Lead_analysis’ to use the data frame generated by the second function. 
This should be followed by the standard that was used to monitor baseline drift (e.g. “1 ppb standard”), then the standard curve samples (e.g. “10 ppb metal standard”). 

For example, run this script in R to determine lead concentration with drift adjustment: 
setup_all1("Sample_run_HeavyMetalstest_modified.csv")
setup_lead2("Pb_208", Intensities)
analyse_lead_withdrift3(Lead_analysis, "1 ppb standard", "0.0004 ppb metal standard", "0.002 ppb metal standard", "0.02 ppb metal standard", "0.1 ppb metal standard", "0.5 ppb metal standard", "1 ppb metal standard", "5 ppb metal standard", "10 ppb metal standard")

To install this package directly in R studio, run the following code: 
install.packages("devtools")
devtools::install_github("Tomas-RS/ICPMSheavymetals")
library(ICPMSheavymetals)
